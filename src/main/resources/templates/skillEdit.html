<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>学習編集</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/skillEdit.css}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div th:replace="~{fragments/logoutHeader :: logoutHeader}"></div>

    <main class="custom-container">
        <!-- 月選択 -->
        <form method="get" action="/learning/edit" class="month-form">
            <select name="month" onchange="this.form.submit()" class="form-select w-auto d-inline-block">
                <option th:each="m : ${selectableMonths}"
                        th:value="${m}"
                        th:text="${m.monthValue + '月'}"
                        th:selected="${m.toString() == targetMonth}">
                </option>
            </select>
        </form>

        <form th:action="@{/learning/edit}" method="post" th:object="${form}">
            <input type="hidden" th:field="*{targetMonth}"/>

            <!-- バックエンド -->
            <div class="card mb-4">
                <div class="card-header">
                    <div class="category-title">バックエンド</div>
                    <a href="/skill/new?category=1" class="btn-add">項目を追加する</a>
                </div>
                <div class="card-body scrollable-table-wrapper">
                    <div class="card-table-header">
                        <div class="cell name">項目名</div>
                        <div class="cell time">学習時間</div>
                        <div class="cell save-button"></div>
                        <div class="cell delete-button"></div>
                    </div>

                    <div class="card-row" th:each="data, stat : *{backendList}">
                        <input type="hidden" th:field="*{backendList[__${stat.index}__].id}"/>
                        <input type="hidden" th:field="*{backendList[__${stat.index}__].learningName}"/>

                        <div class="cell name" th:text="*{backendList[__${stat.index}__].learningName}"></div>

                        <div class="cell time">
                            <select class="form-select" th:field="*{backendList[__${stat.index}__].learningTime}">
                                <option th:each="m : ${#numbers.sequence(0, 1440)}"
                                        th:value="${m}" th:text="${m}"></option>
                            </select>
                        </div>

                        <div class="cell save-button">
                            <button class="btn-save" type="submit">学習時間を保存する</button>
                        </div>
                        
                        <div class="cell delete-button">
                            <button class="btn-delete" type="button" onclick="alert('削除は未実装です')">削除する</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- フロントエンド -->
            <div class="card mb-4">
                <div class="card-header">
                    <div class="category-title">フロントエンド</div>
                    <a href="/skill/new?category=2" class="btn-add">項目を追加する</a>
                </div>
                <div class="card-body scrollable-table-wrapper">
                    <div class="card-table-header">
                        <div class="cell name">項目名</div>
                        <div class="cell time">学習時間</div>
                        <div class="cell save-button"></div>
                        <div class="cell delete-button"></div>
                    </div>

                    <div class="card-row" th:each="data, stat : *{frontendList}">
                        <input type="hidden" th:field="*{frontendList[__${stat.index}__].id}"/>
                        <input type="hidden" th:field="*{frontendList[__${stat.index}__].learningName}"/>

                        <div class="cell name" th:text="*{frontendList[__${stat.index}__].learningName}"></div>

                        <div class="cell time">
                            <select class="form-select" th:field="*{frontendList[__${stat.index}__].learningTime}">
                                <option th:each="m : ${#numbers.sequence(0, 1440)}"
                                        th:value="${m}" th:text="${m}"></option>
                            </select>
                        </div>

                        <div class="cell save-button">
                            <button class="btn-save" type="submit">学習時間を保存する</button>
                        </div>

                        <div class="cell delete-button">
                            <button class="btn-delete" type="button" onclick="alert('削除は未実装です')">削除する</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- インフラ -->
            <div class="card mb-4">
                <div class="card-header">
                    <div class="category-title">インフラ</div>
                    <a href="/skill/new?category=3" class="btn-add">項目を追加する</a>
                </div>
                <div class="card-body scrollable-table-wrapper">
                    <div class="card-table-header">
                        <div class="cell name">項目名</div>
                        <div class="cell time">学習時間</div>
                        <div class="cell save-button"></div>
                        <div class="cell delete-button"></div>
                    </div>

                    <div class="card-row" th:each="data, stat : *{infraList}">
                        <input type="hidden" th:field="*{infraList[__${stat.index}__].id}"/>
                        <input type="hidden" th:field="*{infraList[__${stat.index}__].learningName}"/>

                        <div class="cell name" th:text="*{infraList[__${stat.index}__].learningName}"></div>

                        <div class="cell time">
                            <select class="form-select" th:field="*{infraList[__${stat.index}__].learningTime}">
                                <option th:each="m : ${#numbers.sequence(0, 1440)}"
                                        th:value="${m}" th:text="${m}"></option>
                            </select>
                        </div>

                        <div class="cell save-button">
                            <button class="btn-save" type="submit">学習時間を保存する</button>
                        </div>

                        <div class="cell delete-button">
                            <button class="btn-delete" type="button" onclick="alert('削除は未実装です')">削除する</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>       